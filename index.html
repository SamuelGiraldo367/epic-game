<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>üåç English World Quiz ‚Äî High Score & Images</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    :root{
      --bg:#0f172a; --muted:#94a3b8; --accent:#22d3ee;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family:Inter,system-ui,Arial; background:radial-gradient(1200px 700px at 20% -10%, rgba(34,211,238,.06), transparent), var(--bg); color:#e6eef6}
    header{padding:20px;text-align:center}
    header h1{margin:0;font-size:clamp(20px,3.4vw,32px)}
    .container{max-width:1200px;margin:16px auto;padding:0 16px;display:grid;grid-template-columns:1fr 360px;gap:16px}
    @media(max-width:980px){.container{grid-template-columns:1fr}}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.02), rgba(255,255,255,.01)); border-radius:14px;border:1px solid rgba(148,163,184,.06); overflow:hidden}
    .title{display:flex;align-items:center;gap:10px;padding:12px 14px;border-bottom:1px solid rgba(148,163,184,.06)}
    #map{height:62vh; min-height:420px}
    .panel{padding:14px;display:grid;gap:12px}
    label{color:var(--muted);font-size:14px}
    select,button{padding:9px 12px;border-radius:10px;border:1px solid rgba(148,163,184,.12);background:rgba(2,6,23,.6);color:#e6eef6}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid rgba(148,163,184,.12);cursor:pointer;margin:4px;background:rgba(2,6,23,.45)}
    .pill[data-active="true"]{background:rgba(34,211,238,.12);border-color:var(--accent)}
    .options{display:grid;gap:8px}
    .option{padding:10px;border-radius:10px;border:1px solid rgba(148,163,184,.12);background:rgba(2,6,23,.45);cursor:pointer;text-align:left}
    .option.correct{border-color:#22c55e;background:rgba(34,197,94,.12)}
    .option.wrong{border-color:#ef4444;background:rgba(239,68,68,.08)}
    .status{display:flex;justify-content:space-between;align-items:center;color:var(--muted)}
    .tag{padding:6px 10px;border-radius:999px;background:rgba(2,6,23,.5);border:1px solid rgba(148,163,184,.12)}
    .media{max-height:160px;border-radius:10px;display:none;width:100%;object-fit:cover;border:1px solid rgba(148,163,184,.06)}
    footer{text-align:center;padding:12px;color:var(--muted);font-size:13px}
    /* confetti */
    .confetti{position:fixed;width:10px;height:12px;top:-20px;z-index:9999;border-radius:2px;opacity:.95;animation:fall linear forwards}
    @keyframes fall{from{transform:translateY(-10vh) rotate(0deg)} to{transform:translateY(110vh) rotate(720deg)}}
    /* small helper */
    .small{font-size:13px;color:var(--muted)}
    .controls-row{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  </style>
</head>
<body>
  <header>
    <h1>üåç English World Quiz</h1>
    <p class="small">Click a country ‚Üí answer questions in English. Use difficulty and topics to filter.</p>
  </header>

  <main class="container">
    <section class="card">
      <div class="title"><strong>Interactive World Map</strong></div>
      <div id="map"></div>
    </section>

    <aside class="card">
      <div class="title"><strong>Game Panel</strong></div>
      <div class="panel">
        <div class="controls-row">
          <div>
            <label for="difficulty">Difficulty</label>
            <select id="difficulty"><option value="easy">Easy (6th‚Äì7th)</option><option value="medium">Medium (8th‚Äì9th)</option><option value="hard">Hard (10th‚Äì11th)</option></select>
          </div>
          <div>
            <label for="mode">Mode</label>
            <select id="mode"><option value="timed">Timed (60s)</option><option value="classic">Classic (No limit)</option></select>
          </div>
        </div>

        <div>
          <label>Topics</label>
          <div id="topics" style="margin-top:8px">
            <span class="pill" data-topic="countries" data-active="true">Countries</span>
            <span class="pill" data-topic="foods" data-active="true">Foods</span>
            <span class="pill" data-topic="animals" data-active="true">Animals</span>
            <span class="pill" data-topic="weather" data-active="true">Weather</span>
          </div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
          <button id="resetBtn" class="btn ghost">Reset</button>
          <button id="startBtn" class="btn primary">Start / Update</button>
        </div>

        <div class="status" style="margin-top:8px">
          <div>Score: <strong id="score">0</strong></div>
          <div>Lives: <strong id="lives">3</strong></div>
          <div>High Score: <strong id="highscore">0</strong></div>
          <div id="timerWrap">‚è± <strong id="timer">60</strong>s</div>
        </div>

        <div id="activeTags" style="margin-top:8px;display:flex;gap:6px;flex-wrap:wrap"></div>

        <hr style="border:none;border-top:1px solid rgba(148,163,184,.06)">

        <div class="qa">
          <img id="qImage" class="media" alt="Question image"/>
          <h3 id="qText">Pick a country to get your first question.</h3>
          <div class="options" id="options"></div>
        </div>

        <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
          <button id="clearHigh" class="btn ghost">Clear High Score</button>
          <div class="small" style="margin-left:auto;color:var(--muted)">Milestones: confetti at 10,20,...</div>
        </div>

      </div>
    </aside>
  </main>

  <footer>Built for learning English: countries, foods, animals, and weather.</footer>

  <!-- audio -->
  <audio id="celebration-sound"><source src="https://www.soundjay.com/buttons/sounds/button-16.mp3" type="audio/mpeg"></audio>
  <audio id="highscore-sound"><source src="https://www.soundjay.com/human/sounds/applause-8.mp3" type="audio/mpeg"></audio>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // ---------- Utils ----------
    const $ = id => document.getElementById(id);
    const shuffle = arr => arr.map(v => ({k: Math.random(), v})).sort((a,b)=>a.k-b.k).map(x=>x.v);

    // ---------- State ----------
    const state = {
      difficulty: 'easy',
      mode: 'timed',
      topics: new Set(['countries','foods','animals','weather']),
      score: 0,
      lives: 3,
      timer: null,
      timeLeft: 60,
      current: null,
      milestonesHit: new Set(),
      highScore: 0
    };

    // ---------- High score (localStorage) ----------
    const HS_KEY = 'world_quiz_highscore_v1';
    function loadHighScore(){
      const v = parseInt(localStorage.getItem(HS_KEY) || '0', 10) || 0;
      state.highScore = v;
      $('highscore').textContent = v;
    }
    function saveHighScore(val){
      state.highScore = val;
      localStorage.setItem(HS_KEY, String(val));
      $('highscore').textContent = val;
      // play special sound + confetti
      const a = $('highscore-sound'); a.currentTime=0; a.play().catch(()=>{});
      launchConfetti();
    }
    $('clearHigh').addEventListener('click', ()=>{
      if(confirm('Clear saved high score?')) {
        localStorage.removeItem(HS_KEY);
        loadHighScore();
        alert('High score cleared.');
      }
    });

    // ---------- Topic UI ----------
    document.getElementById('topics').addEventListener('click', e=>{
      if(!e.target.classList.contains('pill')) return;
      const topic = e.target.dataset.topic;
      const active = e.target.getAttribute('data-active') === 'true';
      e.target.setAttribute('data-active', String(!active));
      if(active) state.topics.delete(topic); else state.topics.add(topic);
      renderActiveTags();
      resetCurrentCountryBank();
    });

    $('difficulty').addEventListener('change', e=>{
      state.difficulty = e.target.value;
      resetCurrentCountryBank();
    });
    $('mode').addEventListener('change', e=>{
      state.mode = e.target.value;
      updateTimerVisibility();
    });

    $('startBtn').addEventListener('click', startGame);
    $('resetBtn').addEventListener('click', fullReset);

    function renderActiveTags(){
      const wrap = $('activeTags');
      wrap.innerHTML = '';
      state.topics.forEach(t=>{
        const el = document.createElement('div'); el.className='tag'; el.textContent = t.charAt(0).toUpperCase()+t.slice(1); wrap.appendChild(el);
      });
      if(state.topics.size===0){ const w = document.createElement('div'); w.className='tag'; w.textContent='No topics!'; wrap.appendChild(w); }
    }
    renderActiveTags();
    function updateTimerVisibility(){ $('timerWrap').style.display = state.mode==='timed' ? 'block' : 'none'; }

    // ---------- Confetti ----------
    function launchConfetti(){
      for(let i=0;i<100;i++){
        const d = document.createElement('div'); d.className='confetti';
        d.style.left = Math.random()*100 + 'vw';
        d.style.backgroundColor = ['#f59e0b','#22c55e','#38bdf8','#ef4444','#a78bfa','#f472b6'][Math.floor(Math.random()*6)];
        d.style.width = (6+Math.random()*9)+'px'; d.style.height = (8+Math.random()*14)+'px';
        d.style.animationDuration = (1.8 + Math.random()*1.6) + 's';
        d.style.transform = 'rotate('+(Math.random()*360)+'deg)';
        document.body.appendChild(d);
        setTimeout(()=>d.remove(), 3800);
      }
    }

    function celebrateIfMilestone(){
      const milestones = [10,20,30,40,50];
      if(milestones.includes(state.score) && !state.milestonesHit.has(state.score)){
        state.milestonesHit.add(state.score);
        launchConfetti();
        const audio = $('celebration-sound'); audio.currentTime=0; audio.play().catch(()=>{});
      }
      // update high score if beaten
      if(state.score > state.highScore){
        saveHighScore(state.score);
      }
    }

    // ---------- Countries DB (25 countries, some questions include 'img') ----------
    // Structure: countriesDB = { CODE: { country, lat, lng, questions: { topic: { difficulty: [ {q, options, answer, img?} ] } } } }
    // NOTE: answers point to the index in options; we'll shuffle options when rendering
    const countriesDB = {
      /* AMERICAS (5) */
      AR: { country:'Argentina', lat:-38.4161, lng:-63.6167,
        questions: {
          countries: {
            easy:[
              {q:'What is the capital of Argentina?', options:['Buenos Aires','C√≥rdoba','Rosario','Mendoza'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/1/12/Buenos_Aires_City.jpg'},
              {q:'Argentina is located on which continent?', options:['South America','Europe','Africa','Asia'], answer:0}
            ],
            medium:[
              {q:'Which dance is Argentina famous for?', options:['Tango','Samba','Flamenco','Waltz'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/7/7e/Tango_Dancers_Buenos_Aires.jpg'},
              {q:'Which ocean borders Argentina to the east?', options:['Atlantic','Pacific','Indian','Arctic'], answer:0}
            ],
            hard:[
              {q:'Which language is official in Argentina?', options:['Spanish','Portuguese','English','French'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'What is "asado"?', options:['Argentine barbecue','Soup','Dessert','Bread'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/9/9b/Parrilla_-_asado_argentino.JPG'},
              {q:'What is an empanada?', options:['A stuffed pastry','A drink','A soup','A salad'], answer:0}
            ],
            medium:[
              {q:'Which drink is popular in Argentina?', options:['Mate','Green tea','Coffee','Soda'], answer:0}
            ],
            hard:[
              {q:'Dulce de leche is similar to which sweet?', options:['Caramel','Honey','Jam','Syrup'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which big cat can be found in parts of Argentina?', options:['Jaguar','Lion','Tiger','Cheetah'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/9/9f/Standing_jaguar.jpg'}
            ],
            medium:[
              {q:'Which camelid is native to Patagonia?', options:['Guanaco','Llama','Alpaca','Vicuna'], answer:0}
            ],
            hard:[
              {q:'The Andean condor primarily feeds on?', options:['Carrion','Fish','Fruit','Insects'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/6/69/2_Andean_Condor.jpg'}
            ]
          },
          weather:{
            easy:[
              {q:'Patagonia is usually?', options:['Cold and windy','Hot and humid','Tropical','Arid desert'], answer:0}
            ],
            medium:[
              {q:'When is summer in Argentina?', options:['December‚ÄìFebruary','June‚ÄìAugust','March‚ÄìMay','September‚ÄìNovember'], answer:0}
            ],
            hard:[
              {q:'Which region of Argentina has very hot summers?', options:['Gran Chaco','Patagonia','Andes','Pampas'], answer:0}
            ]
          }
      }},
      BR: { country:'Brazil', lat:-14.235, lng:-51.9253,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Brazil?', options:['Bras√≠lia','Rio de Janeiro','S√£o Paulo','Salvador'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/0/0f/Brasilia_-_Palacio_da_Alvorada.jpg'},
              {q:'Brazil is on which continent?', options:['South America','Europe','Africa','Asia'], answer:0}
            ],
            medium:[
              {q:'Which river runs through much of Brazil?', options:['Amazon','Nile','Danube','Mississippi'], answer:0}
            ],
            hard:[
              {q:"What's Brazil's official language?", options:['Portuguese','Spanish','English','French'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a traditional Brazilian dish?', options:['Feijoada','Paella','Sushi','Taco'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/7/71/Feijoada.jpg'}
            ],
            medium:[
              {q:'A√ßa√≠ is commonly eaten as a...', options:['Bowl','Soup','Cake','Bread'], answer:0}
            ],
            hard:[
              {q:'P√£o de queijo is mainly made from?', options:['Cassava starch','Wheat','Corn','Rice'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which animal lives in the Amazon?', options:['Jaguar','Polar bear','Kangaroo','Penguin'], answer:0}
            ],
            medium:[
              {q:'Which dolphin is pink and lives in Amazon rivers?', options:['Amazon river dolphin','Bottlenose','Orca','Spinner'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/6/68/Amazon_river_dolphin_2.jpg'}
            ],
            hard:[
              {q:'The Pantanal is famous for many species of?', options:['Caimans','Penguins','Polar bears','Camels'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Near the equator, Brazil usually has what climate?', options:['Tropical','Polar','Arid','Mediterranean'], answer:0}
            ],
            medium:[
              {q:'The Amazon rainforest is known for high?', options:['Humidity','Snowfall','Sandstorms','Heatwaves'], answer:0}
            ],
            hard:[
              {q:'The Sert√£o region is mostly?', options:['Semi-arid','Rainforest','Tundra','Alpine'], answer:0}
            ]
          }
      }},
      US: { country:'United States', lat:38.9, lng:-95.7,
        questions:{
          countries:{
            easy:[
              {q:'Capital of the United States?', options:['Washington, D.C.','New York','Los Angeles','Chicago'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/3/3b/US_Capitol_west_front_edit2.jpg'},
              {q:'How many states are in the USA?', options:['50','48','52','49'], answer:0}
            ],
            medium:[
              {q:'Which state has the Grand Canyon?', options:['Arizona','Utah','Colorado','Nevada'], answer:0}
            ],
            hard:[
              {q:'Which ocean borders the US west coast?', options:['Pacific','Atlantic','Indian','Arctic'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a classic American food?', options:['Hamburger','Sushi','Paella','Bibimbap'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/4/4f/Hamburger_%28black_bg%29.jpg'}
            ],
            medium:[
              {q:'Which holiday traditionally features turkey?', options:['Thanksgiving','Halloween','Easter','Valentine\'s'], answer:0}
            ],
            hard:[
              {q:'Clam chowder is typical of which region?', options:['New England','Deep South','Midwest','Pacific Northwest'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'National bird of the U.S.?', options:['Bald eagle','Robin','Sparrow','Owl'], answer:0}
            ],
            medium:[
              {q:'Which large mammal roamed the plains?', options:['Bison','Kangaroo','Elephant','Moose'], answer:0}
            ],
            hard:[
              {q:'Manatees are mainly found in which US state?', options:['Florida','Alaska','California','Oregon'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Florida summers are usually what?', options:['Hot and humid','Cold and snowy','Mild and dry','Arctic'], answer:0}
            ],
            medium:[
              {q:'The Midwest sometimes has which severe weather?', options:['Tornadoes','Hurricanes','Typhoons','Volcanic ash'], answer:0}
            ],
            hard:[
              {q:'Which US region is known as Tornado Alley?', options:['Central US Plains','California coast','Northeast','Pacific Northwest'], answer:0}
            ]
          }
      }},
      MX: { country:'Mexico', lat:23.6345, lng:-102.5528,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Mexico?', options:['Mexico City','Guadalajara','Monterrey','Canc√∫n'], answer:0}
            ],
            medium:[
              {q:'Mexico is part of which continent?', options:['North America','South America','Europe','Asia'], answer:0}
            ],
            hard:[
              {q:'Which ancient civilization lived in Mexico?', options:['Maya','Inca','Aztec people','Olmec (both Olmec and Maya existed; Maya answer would normally be correct depending on region)'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a typical Mexican food?', options:['Taco','Sushi','Paella','Pierogi'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/9/97/Street_tacos_in_mexico.jpg'}
            ],
            medium:[
              {q:'Mole is a type of?', options:['Sauce','Dessert','Bread','Cheese'], answer:0}
            ],
            hard:[
              {q:'Which fruit is main ingredient in guacamole?', options:['Avocado','Banana','Apple','Pear'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which reptile is common in Mexico?', options:['Iguana','Penguin','Polar bear','Kangaroo'], answer:0}
            ],
            medium:[
              {q:'Monarch butterflies migrate to which country?', options:['Mexico','Brazil','Japan','Australia'], answer:0}
            ],
            hard:[
              {q:'Which marine species migrates along the Baja coast?', options:['Gray whale','Dolphin','Manatee','Seal'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Many parts of Mexico have which climate?', options:['Tropical','Polar','Arctic','Tundra'], answer:0}
            ],
            medium:[
              {q:'Which coast gets hurricanes in Mexico?', options:['East coast (Gulf)','West coast','Both rarely','No coast'], answer:0}
            ],
            hard:[
              {q:'Which desert is partly in northern Mexico?', options:['Chihuahuan Desert','Sahara','Gobi','Atacama'], answer:0}
            ]
          }
      }},
      CO: { country:'Colombia', lat:4.7110, lng:-74.0721,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Colombia?', options:['Bogot√°','Medell√≠n','Cali','Cartagena'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/f/f1/Bogota_City.jpg'}
            ],
            medium:[
              {q:'Colombia is on which continent?', options:['South America','North America','Europe','Asia'], answer:0}
            ],
            hard:[
              {q:'Colombia has coasts on which oceans?', options:['Pacific and Atlantic','Indian','Arctic','None'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a Colombian food?', options:['Arepa','Sushi','Pizza','Taco'], answer:0}
            ],
            medium:[
              {q:'Bandeja paisa is a dish that typically includes?', options:['Beans and meat','Rice only','Fish only','Bread only'], answer:0}
            ],
            hard:[
              {q:'Ajiaco is a type of?', options:['Soup','Dessert','Bread','Sauce'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which bird is iconic in Colombia?', options:['Andean condor','Penguin','Ostrich','Kiwi'], answer:0}
            ],
            medium:[
              {q:'Which frog is famous and brightly colored in Colombian rainforests?', options:['Poison dart frog','Tree frog','Toad','Newt'], answer:0}
            ],
            hard:[
              {q:'Which mammal is the largest rodent native to South America?', options:['Capybara','Beaver','Porcupine','Rat'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Colombia near the equator tends to be?', options:['Tropical','Polar','Arid','Temperate'], answer:0}
            ],
            medium:[
              {q:'Higher areas like Bogot√° have what climate?', options:['Mild/cool (spring-like)','Hot tropical','Desert','Arctic'], answer:0}
            ],
            hard:[
              {q:'Which region of Colombia gets extremely high rainfall?', options:['Pacific coast','Andes','Llanos','Desert'], answer:0}
            ]
          }
      }},

      /* EUROPE (5) */
      FR: { country:'France', lat:48.8566, lng:2.3522,
        questions:{
          countries:{
            easy:[
              {q:'Capital of France?', options:['Paris','Lyon','Marseille','Nice'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/a/af/Tour_Eiffel_Wikimedia_Commons.jpg'},
              {q:'France is in which continent?', options:['Europe','Asia','Africa','Oceania'], answer:0}
            ],
            medium:[
              {q:'Which river flows through Paris?', options:['Seine','Thames','Danube','Rhine'], answer:0}
            ],
            hard:[
              {q:'Mont Blanc is in which mountain range?', options:['Alps','Pyrenees','Andes','Rockies'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a French bread?', options:['Baguette','Naan','Tortilla','Rye'], answer:0}
            ],
            medium:[
              {q:'Ratatouille is a dish made of?', options:['Stewed vegetables','Meat','Fish','Bread'], answer:0}
            ],
            hard:[
              {q:'Cr√®me br√ªl√©e has a top made of?', options:['Caramelized sugar','Frosting','Meringue','Chocolate'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Camargue region is famous for which animals?', options:['Horses','Kangaroos','Penguins','Llamas'], answer:0}
            ],
            medium:[
              {q:'Pyrenees mountains are habitat for which species?', options:['Brown bears','Polar bears','Koalas','Kangaroos'], answer:0}
            ],
            hard:[
              {q:'European robin is a type of?', options:['Bird','Mammal','Reptile','Fish'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Mediterranean coast of France is usually?', options:['Sunny and warm','Polar','Tundra','Arid'], answer:0}
            ],
            medium:[
              {q:'Northern France winters are often?', options:['Mild and rainy','Extremely hot','Always snowy','Always sunny'], answer:0}
            ],
            hard:[
              {q:'Mistral is a strong wind in which country?', options:['France','Italy','Spain','Greece'], answer:0}
            ]
          }
      }},
      ES: { country:'Spain', lat:40.4168, lng:-3.7038,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Spain?', options:['Madrid','Barcelona','Seville','Valencia'], answer:0}
            ],
            medium:[
              {q:'Which region celebrates La Tomatina?', options:['Bu√±ol (Valencia province)','Madrid','Seville','Barcelona'], answer:0}
            ],
            hard:[
              {q:'Which mountain range forms part of the border with France?', options:['Pyrenees','Alps','Carpathians','Andes'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'What is paella?', options:['A rice dish from Spain','A type of sushi','A soup','A dessert'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/a/a3/Paella_Valenciana.jpg'}
            ],
            medium:[
              {q:'Tapas are best described as?', options:['Small plates','Large dinners','Beverages only','Desserts only'], answer:0}
            ],
            hard:[
              {q:'Jam√≥n ib√©rico is which kind of food?', options:['Cured ham','Cheese','Bread','Olive'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which large cat is native to parts of Spain?', options:['Iberian lynx','Tiger','Lion','Jaguar'], answer:0}
            ],
            medium:[
              {q:'Which sea borders eastern Spain?', options:['Mediterranean Sea','North Sea','Baltic Sea','Black Sea'], answer:0}
            ],
            hard:[
              {q:'Which islands are Spanish territories?', options:['Balearic and Canary Islands','Hawaii','Azores','Falklands'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Southern Spain has which climate?', options:['Hot and dry','Cold and snowy','Tropical','Polar'], answer:0}
            ],
            medium:[
              {q:'Northern Spain near the Bay of Biscay is more?', options:['Rainy','Dry','Arid','Frozen'], answer:0}
            ],
            hard:[
              {q:'Spain‚Äôs highest peak (Teide) is on which island?', options:['Tenerife','Mallorca','Ibiza','Menorca'], answer:0}
            ]
          }
      }},
      DE: { country:'Germany', lat:51.1657, lng:10.4515,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Germany?', options:['Berlin','Munich','Frankfurt','Hamburg'], answer:0}
            ],
            medium:[
              {q:'Germany is on which continent?', options:['Europe','Asia','Africa','Oceania'], answer:0}
            ],
            hard:[
              {q:'Which river runs through Cologne?', options:['Rhine','Danube','Seine','Thames'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a German food?', options:['Pretzel','Sushi','Taco','Empanada'], answer:0}
            ],
            medium:[
              {q:'Bratwurst is a type of?', options:['Sausage','Bread','Cheese','Soup'], answer:0}
            ],
            hard:[
              {q:'Sauerkraut is made from?', options:['Fermented cabbage','Fish','Meat','Potatoes'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which animal appears in German folklore?', options:['Wolf','Kangaroo','Penguin','Koala'], answer:0}
            ],
            medium:[
              {q:'Which region contains the Black Forest?', options:['Baden-W√ºrttemberg','Bavaria','Saxony','Hesse'], answer:0}
            ],
            hard:[
              {q:'Which sea is north of Germany?', options:['North Sea','Mediterranean','Black Sea','Red Sea'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Winters in Germany are typically?', options:['Cold and temperate','Tropical','Desert','Arctic'], answer:0}
            ],
            medium:[
              {q:'Oktoberfest is traditionally held in which city?', options:['Munich','Berlin','Hamburg','Frankfurt'], answer:0}
            ],
            hard:[
              {q:'Which German region is known for vineyards?', options:['Rhineland','Saxony','Bavaria','Brandenburg'], answer:0}
            ]
          }
      }},
      GB: { country:'United Kingdom', lat:55.3781, lng:-3.4360,
        questions:{
          countries:{
            easy:[
              {q:'Capital of the UK?', options:['London','Edinburgh','Cardiff','Belfast'], answer:0}
            ],
            medium:[
              {q:'How many countries make up the UK?', options:['4','3','2','5'], answer:0}
            ],
            hard:[
              {q:'Which current warms the UK climate?', options:['Gulf Stream','Labrador Current','Benguela Current','Humboldt Current'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a typical British dish?', options:['Fish and chips','Tacos','Sushi','Paella'], answer:0}
            ],
            medium:[
              {q:'A traditional British pastry is called a?', options:['Cornish pasty','Empanada','Samosa','Pierogi'], answer:0}
            ],
            hard:[
              {q:'Which pudding is common in British cuisine?', options:['Sticky toffee pudding','Mochi','Baklava','Cannoli'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which small bird is common in UK gardens?', options:['Robin','Penguin','Kiwi','Ostrich'], answer:0}
            ],
            medium:[
              {q:'Red deer are native to which habitat?', options:['Highlands','Desert','Rainforest','Steppe'], answer:0}
            ],
            hard:[
              {q:'Which cliffs are famous on the south coast of England?', options:['White Cliffs of Dover','Cliffs of Moher','Cliffs of √âtretat','Trolltunga'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'UK weather often is?', options:['Rainy and changeable','Desert-like','Tropical','Arctic'], answer:0}
            ],
            medium:[
              {q:'Which season is typically warmest in the UK?', options:['Summer (Jun‚ÄìAug)','Winter (Dec‚ÄìFeb)','Autumn (Sep‚ÄìNov)','Spring (Mar‚ÄìMay)'], answer:0}
            ],
            hard:[
              {q:'Which phenomenon brings mild air to the UK?', options:['Gulf Stream','El Ni√±o','La Ni√±a','Labrador Current'], answer:0}
            ]
          }
      }},

      /* ASIA (5) */
      JP: { country:'Japan', lat:35.68, lng:139.76,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Japan?', options:['Tokyo','Osaka','Kyoto','Sapporo'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/1/12/Tokyo_Tower_and_surroundings.jpg'},
              {q:'Japan is an island nation. True or False?', options:['True','False','Not sure','Both'], answer:0}
            ],
            medium:[
              {q:'Which sea lies west of Japan?', options:['Sea of Japan','East China Sea','South China Sea','Yellow Sea'], answer:0}
            ],
            hard:[
              {q:'Which mountain is a symbol of Japan?', options:['Mount Fuji','Mount Cook','Mount Kilimanjaro','Mount Everest'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is Japanese food?', options:['Sushi','Taco','Paella','Pizza'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/6/60/Sushi_platter.jpg'}
            ],
            medium:[
              {q:'Miso soup is made from which ingredient?', options:['Fermented soy','Wheat','Rice','Corn'], answer:0}
            ],
            hard:[
              {q:'Tempura is a cooking technique of?', options:['Deep-frying','Steaming','Grilling','Smoking'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which monkey is native to Japan?', options:['Japanese macaque (snow monkey)','Capuchin','Baboon','Langur'], answer:0}
            ],
            medium:[
              {q:'The red-crowned crane symbolizes?', options:['Longevity','Strength','Speed','Fire'], answer:0}
            ],
            hard:[
              {q:'Which small island bird is native to Japan?', options:['Japanese wagtail','Penguin','Kiwi','Emu'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Cherry blossoms bloom in which season?', options:['Spring','Summer','Autumn','Winter'], answer:0}
            ],
            medium:[
              {q:'Japan often has which extreme weather in late summer?', options:['Typhoons','Blizzards','Sandstorms','Droughts'], answer:0}
            ],
            hard:[
              {q:'Which island of Japan is known for heavy snow?', options:['Hokkaido','Okinawa','Shikoku','Kyushu'], answer:0}
            ]
          }
      }},
      CN: { country:'China', lat:35.8617, lng:104.1954,
        questions:{
          countries:{
            easy:[
              {q:'Capital of China?', options:['Beijing','Shanghai','Guangzhou','Shenzhen'], answer:0}
            ],
            medium:[
              {q:'China is located in which continent?', options:['Asia','Europe','Africa','Oceania'], answer:0}
            ],
            hard:[
              {q:'Which river is the longest in China?', options:['Yangtze','Yellow River','Mekong','Ganges'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a Chinese food?', options:['Dumplings','Pizza','Tacos','Sushi'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/6/6e/Peking_duck.jpg'}
            ],
            medium:[
              {q:'Peking duck is associated with which city?', options:['Beijing','Shanghai','Chongqing','Guangzhou'], answer:0}
            ],
            hard:[
              {q:'Mapo tofu originates from which Chinese province?', options:['Sichuan','Guangdong','Jiangsu','Hunan'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which bear is native to China?', options:['Giant panda','Polar bear','Grizzly','Black bear'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/0/0f/Grosser_Panda.JPG'}
            ],
            medium:[
              {q:'The Yangtze river dolphin is now?', options:['Functionally extinct','Common','Invasive','Endangered but abundant'], answer:0}
            ],
            hard:[
              {q:'Which desert is in northern China?', options:['Gobi','Sahara','Atacama','Kalahari'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Northern China has what sort of winters?', options:['Cold and dry','Warm and wet','Tropical','Mild'], answer:0}
            ],
            medium:[
              {q:'China is affected by monsoon rains mostly in which season?', options:['Summer','Winter','Autumn','Spring'], answer:0}
            ],
            hard:[
              {q:'Which plateau is known as the roof of the world?', options:['Tibetan Plateau','Deccan Plateau','Colorado Plateau','Antarctic Plateau'], answer:0}
            ]
          }
      }},
      IN: { country:'India', lat:20.5937, lng:78.9629,
        questions:{
          countries:{
            easy:[
              {q:'Capital of India?', options:['New Delhi','Mumbai','Kolkata','Chennai'], answer:0},
              {q:'India is on which continent?', options:['Asia','Europe','Africa','Oceania'], answer:0}
            ],
            medium:[
              {q:'Which mountain range is in northern India?', options:['Himalayas','Andes','Alps','Rockies'], answer:0}
            ],
            hard:[
              {q:'Which river is sacred in much of India?', options:['Ganges','Nile','Amazon','Danube'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a common Indian bread?', options:['Naan','Tortilla','Baguette','Rye'], answer:0}
            ],
            medium:[
              {q:'Biryani is primarily a dish based on?', options:['Rice','Bread','Pasta','Potatoes'], answer:0}
            ],
            hard:[
              {q:'Which cheese is common in Indian cooking?', options:['Paneer','Mozzarella','Cheddar','Brie'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which big cat lives in India?', options:['Bengal tiger','Lion','Jaguar','Polar bear'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/5/56/Bengal_Tiger_%28Panthera_tigris_tigris%29.jpg'}
            ],
            medium:[
              {q:'Which bird is India‚Äôs national bird?', options:['Peacock','Eagle','Sparrow','Pigeon'], answer:0}
            ],
            hard:[
              {q:'Which wetland in India is famous for birdlife?', options:['Keoladeo National Park','Yellowstone','Kruger','Serengeti'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'India‚Äôs main rainy season is called?', options:['Monsoon','Dry season','Winter','Autumn'], answer:0}
            ],
            medium:[
              {q:'Which desert is in northwest India?', options:['Thar Desert','Gobi','Sahara','Kalahari'], answer:0}
            ],
            hard:[
              {q:'Which coast is warmer in southern India?', options:['East coast (Bay of Bengal)','West coast (Arabian Sea)','North coast','None'], answer:0}
            ]
          }
      }},
      KR: { country:'South Korea', lat:35.9078, lng:127.7669,
        questions:{
          countries:{
            easy:[
              {q:'Capital of South Korea?', options:['Seoul','Busan','Incheon','Daegu'], answer:0}
            ],
            medium:[
              {q:'South Korea is on which peninsula?', options:['Korean Peninsula','Malay Peninsula','Iberian Peninsula','Scandinavian Peninsula'], answer:0}
            ],
            hard:[
              {q:'Which sea lies to the west of Korea?', options:['Yellow Sea','Sea of Japan','East China Sea','Andaman Sea'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a Korean dish?', options:['Kimchi','Sushi','Taco','Paella'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/9/9b/Kimchi.JPG'}
            ],
            medium:[
              {q:'Bibimbap is essentially?', options:['Rice with vegetables and egg','Soup','Noodle dish','Bread'], answer:0}
            ],
            hard:[
              {q:'Samgyeopsal is grilled which meat?', options:['Pork belly','Beef','Chicken','Tofu'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which bird is common in Korea?', options:['Magpie','Penguin','Ostrich','Kookaburra'], answer:0}
            ],
            medium:[
              {q:'Which island is famous for its volcanic landscapes?', options:['Jeju Island','Hokkaido','Sumatra','Bali'], answer:0}
            ],
            hard:[
              {q:'Which month typically has cherry blossoms in Korea?', options:['April','December','August','June'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Korea has how many main seasons?', options:['Four (spring,summer,autumn,winter)','Two','One','None'], answer:0}
            ],
            medium:[
              {q:'Korean summers are often influenced by?', options:['Monsoon rains','Snowstorms','Dust storms year-round','Tropical cyclones only'], answer:0}
            ],
            hard:[
              {q:'Which wind brings cold dry air in winter to Korea?', options:['Siberian high / continental winds','Trade winds','Monsoon winds','Sea breezes'], answer:0}
            ]
          }
      }},

      /* AFRICA (5) */
      EG: { country:'Egypt', lat:30.0444, lng:31.2357,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Egypt?', options:['Cairo','Alexandria','Giza','Luxor'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/e/e3/Cairo_night.jpg'}
            ],
            medium:[
              {q:'Which river is key to Egypt?', options:['Nile','Amazon','Yangtze','Danube'], answer:0}
            ],
            hard:[
              {q:'Egypt is mainly part of which region?', options:['North Africa','East Africa','West Africa','Central Africa'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Koshari is a mix of?', options:['Rice, lentils and pasta','Bread and cheese','Meat only','Fruit salad'], answer:0}
            ],
            medium:[
              {q:'Tahini is made from?', options:['Sesame seeds','Peanuts','Soy','Coconut'], answer:0}
            ],
            hard:[
              {q:'Ful medames main ingredient is?', options:['Fava beans','Lentils','Chickpeas','Kidney beans'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which desert animal lives in North Africa?', options:['Fennec fox','Polar bear','Moose','Kangaroo'], answer:0}
            ],
            medium:[
              {q:'Nile crocodile is a large which?', options:['Reptile','Mammal','Bird','Fish'], answer:0}
            ],
            hard:[
              {q:'Which bird is commonly seen near the Nile?', options:['Egyptian vulture','Penguin','Albatross','Kiwi'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Egypt‚Äôs climate is mainly?', options:['Desert (arid)','Temperate','Tropical','Polar'], answer:0}
            ],
            medium:[
              {q:'Khamsin is a type of?', options:['Hot dry wind','Cold wind','Rainstorm','Mist'], answer:0}
            ],
            hard:[
              {q:'The Nile Delta summers tend to be?', options:['Hot and humid','Cold and snowy','Cool and rainy','Freezing'], answer:0}
            ]
          }
      }},
      ZA: { country:'South Africa', lat:-30.5595, lng:22.9375,
        questions:{
          countries:{
            easy:[
              {q:'One capital of South Africa?', options:['Pretoria (executive)','Cape Town (legislative)','Johannesburg','Durban'], answer:0}
            ],
            medium:[
              {q:'South Africa is on which continent?', options:['Africa','Asia','Europe','Oceania'], answer:0}
            ],
            hard:[
              {q:'Kruger National Park is famous for which activity?', options:['Safari wildlife viewing','Skiing','Whale hunting','Glacier hiking'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which food is South African?', options:['Bobotie','Sushi','Taco','Pierogi'], answer:0}
            ],
            medium:[
              {q:'Biltong is similar to?', options:['Jerky (dried meat)','Candy','Soup','Bread'], answer:0}
            ],
            hard:[
              {q:'Which fruit industry is important in South Africa?', options:['Grapes/wine','Bananas','Coconuts','Citrus only'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which of the "Big Five" lives in South Africa?', options:['Elephant','Polar bear','Kangaroo','Moose'], answer:0}
            ],
            medium:[
              {q:'Which large cat is commonly seen on safari?', options:['Lion','Tiger','Jaguar','Leopard only in some areas'], answer:0}
            ],
            hard:[
              {q:'Which shark is famous off the South African coast?', options:['Great white shark','Hammerhead','Tiger shark','Bull shark'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'South Africa\'s climate is mostly?', options:['Varied: Mediterranean to subtropical','Arctic','Tropical rainforest only','Desert only'], answer:0}
            ],
            medium:[
              {q:'Which province has Mediterranean climate?', options:['Western Cape','Gauteng','Kwazulu-Natal','Limpopo'], answer:0}
            ],
            hard:[
              {q:'Summer in South Africa is in which months?', options:['Dec‚ÄìFeb','Jun‚ÄìAug','Mar‚ÄìMay','Sep‚ÄìNov'], answer:0}
            ]
          }
      }},
      NG: { country:'Nigeria', lat:9.0820, lng:8.6753,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Nigeria?', options:['Abuja','Lagos','Kano','Ibadan'], answer:0}
            ],
            medium:[
              {q:'Which ocean borders southern Nigeria?', options:['Atlantic Ocean','Indian Ocean','Pacific','Arctic'], answer:0}
            ],
            hard:[
              {q:'Nigeria is the most populous country in which region?', options:['Africa','Europe','Asia','Oceania'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which is a Nigerian staple?', options:['Fufu','Sushi','Pizza','Taco'], answer:0}
            ],
            medium:[
              {q:'Jollof rice is popular in which region?', options:['West Africa','East Asia','Europe','South America'], answer:0}
            ],
            hard:[
              {q:'Which nut is used in some Nigerian recipes?', options:['Groundnut (peanut)','Almond','Walnut','Pecan'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which animal is seen in Nigerian savannas?', options:['Antelope','Polar bear','Penguin','Kangaroo'], answer:0}
            ],
            medium:[
              {q:'Which river flows through Nigeria?', options:['Niger River','Nile','Amazon','Danube'], answer:0}
            ],
            hard:[
              {q:'Which large mammal is found in parts of Nigeria?', options:['Elephant','Bison','Moose','Elk'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Nigeria mainly has which climate?', options:['Tropical','Polar','Temperate','Arctic'], answer:0}
            ],
            medium:[
              {q:'The wet season in Nigeria is roughly during?', options:['Summer months / monsoon','December','March','September only'], answer:0}
            ],
            hard:[
              {q:'Northern Nigeria is closer to which ecological zone?', options:['Sahel/ semi-arid','Rainforest','Tundra','Glacier'], answer:0}
            ]
          }
      }},
      KE: { country:'Kenya', lat:-0.0236, lng:37.9062,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Kenya?', options:['Nairobi','Mombasa','Kisumu','Eldoret'], answer:0}
            ],
            medium:[
              {q:'Kenya is in which region of Africa?', options:['East Africa','West Africa','North Africa','Southern Africa'], answer:0}
            ],
            hard:[
              {q:'Which famous reserve is in Kenya?', options:['Maasai Mara','Kruger','Serengeti','Etosha'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Ugali is typically made from?', options:['Maize (corn) meal','Rice','Wheat flour','Potatoes'], answer:0}
            ],
            medium:[
              {q:'Nyama choma is a Kenyan...', options:['Grilled meat','Dessert','Soup','Bread'], answer:0}
            ],
            hard:[
              {q:'Sukuma wiki is a dish made from?', options:['Collard greens','Fruit','Rice','Pasta'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which large mammal is a safari highlight in Kenya?', options:['Elephant','Penguin','Polar bear','Kangaroo'], answer:0}
            ],
            medium:[
              {q:'Which animal takes part in the Great Migration?', options:['Wildebeest','Panda','Polar bear','Camel'], answer:0}
            ],
            hard:[
              {q:'Which bird species can be seen in Lake Nakuru?', options:['Flamingo','Eagle','Kiwi','Penguin'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Kenya generally has which climate?', options:['Tropical to equatorial','Arctic','Desert only','Temperate only'], answer:0}
            ],
            medium:[
              {q:'The coastal areas of Kenya are typically?', options:['Hot and humid','Cold and snowy','Dry and freezing','Tundra'], answer:0}
            ],
            hard:[
              {q:'Long rains in Kenya often occur around which months?', options:['April‚ÄìMay','December','August','February'], answer:0}
            ]
          }
      }},

      /* OCEANIA (5) */
      AU: { country:'Australia', lat:-25.2744, lng:133.7751,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Australia?', options:['Canberra','Sydney','Melbourne','Perth'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/6/6e/Canberra_Australia.jpg'}
            ],
            medium:[
              {q:'Australia is both a country and a?', options:['Continent','Province','State','Island'], answer:0}
            ],
            hard:[
              {q:'Most Australians live near which area?', options:['The coast','Desert','Mountains','Jungle'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which spread is iconic in Australia?', options:['Vegemite','Peanut butter','Marmite','Nutella'], answer:0}
            ],
            medium:[
              {q:'Lamington is a type of?', options:['Cake','Soup','Bread','Pasta'], answer:0}
            ],
            hard:[
              {q:'Pavlova is topped with?', options:['Fruit and cream','Chocolate','Meat','Rice'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which animal is native to Australia?', options:['Kangaroo','Lion','Tiger','Polar bear'], answer:0, img:'https://upload.wikimedia.org/wikipedia/commons/0/0c/Kangaroo_Australia_01.jpg'}
            ],
            medium:[
              {q:'Koalas mainly eat?', options:['Eucalyptus leaves','Bamboo','Grass','Fish'], answer:0}
            ],
            hard:[
              {q:'Platypus is a mammal that?', options:['Lays eggs','Gives live birth','Is a reptile','Is a bird'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Northern Australia climate is?', options:['Tropical','Polar','Arid','Tundra'], answer:0}
            ],
            medium:[
              {q:'The interior of Australia is called the?', options:['Outback','Lowlands','Highlands','Valley'], answer:0}
            ],
            hard:[
              {q:'Which reef is off Australia\'s northeast?', options:['Great Barrier Reef','Belize Barrier Reef','Red Sea Reef','Mesoamerican Reef'], answer:0}
            ]
          }
      }},
      NZ: { country:'New Zealand', lat:-40.9006, lng:174.8860,
        questions:{
          countries:{
            easy:[
              {q:'Capital of New Zealand?', options:['Wellington','Auckland','Christchurch','Dunedin'], answer:0}
            ],
            medium:[
              {q:'New Zealand has two main islands called?', options:['North and South Islands','East and West','Upper and Lower','Inner and Outer'], answer:0}
            ],
            hard:[
              {q:'Which flightless bird is a symbol of New Zealand?', options:['Kiwi','Emu','Penguin','Ostrich'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which dessert is associated with NZ (also Australia)?', options:['Pavlova','Tiramisu','Baklava','Cheesecake'], answer:0}
            ],
            medium:[
              {q:'HƒÅngi is a method of cooking using?', options:['An earth oven (hot stones)','Microwave','Frying pan','Oven'], answer:0}
            ],
            hard:[
              {q:'Lamb is a common meat in which country?', options:['New Zealand','Japan','Mexico','Egypt'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which bird is native to NZ and cannot fly?', options:['Kiwi','Kakapo','Penguin','Ostrich'], answer:0}
            ],
            medium:[
              {q:'Which reptile is endemic to NZ?', options:['Tuatara','Komodo dragon','Iguana','Chameleon'], answer:0}
            ],
            hard:[
              {q:'Which marine mammal may be seen around NZ coasts?', options:['Orca','Manatee','Polar bear','Walrus'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'New Zealand climate is generally?', options:['Temperate maritime','Tropical','Arctic','Desert'], answer:0}
            ],
            medium:[
              {q:'Which island is generally cooler?', options:['South Island','North Island','Both same','Neither'], answer:0}
            ],
            hard:[
              {q:'Orographic rainfall occurs because of?', options:['Mountains forcing air up','Monsoons','Tsunamis','Tornadoes'], answer:0}
            ]
          }
      }},
      PG: { country:'Papua New Guinea', lat:-6.314993, lng:143.95555,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Papua New Guinea?', options:['Port Moresby','Lae','Madang','Goroka'], answer:0}
            ],
            medium:[
              {q:'PNG is in which region?', options:['Oceania','Asia','Europe','Africa'], answer:0}
            ],
            hard:[
              {q:'PNG occupies the eastern half of which island?', options:['New Guinea','Borneo','Sumatra','Sulawesi'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which root is commonly eaten in PNG?', options:['Taro','Potato','Cassava','Yam'], answer:0}
            ],
            medium:[
              {q:'Sago is derived from which plant part?', options:['Palm stems','Wheat','Rice','Maize'], answer:0}
            ],
            hard:[
              {q:'Kaukau refers to which crop?', options:['Sweet potato','Banana','Corn','Cassava'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which bird is famous in PNG?', options:['Bird of paradise','Eagle','Penguin','Ostrich'], answer:0}
            ],
            medium:[
              {q:'PNG is known for rich biodiversity especially in?', options:['Birds','Penguins','Polar bears','Camels'], answer:0}
            ],
            hard:[
              {q:'Which habitat covers much of PNG?', options:['Tropical rainforest','Tundra','Desert','Steppe'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'PNG climate is mostly?', options:['Tropical rainforest','Desert','Arctic','Temperate'], answer:0}
            ],
            medium:[
              {q:'Which ENSO phenomenon affects PNG rainfall?', options:['El Ni√±o/La Ni√±a variations','Monsoon only','Hurricanes only','Blizzards'], answer:0}
            ],
            hard:[
              {q:'Coastal PNG villages often rely on?', options:['Fishing','Reindeer herding','Sheep farming','Cattle grazing'], answer:0}
            ]
          }
      }},
      FJ: { country:'Fiji', lat:-17.7134, lng:178.0650,
        questions:{
          countries:{
            easy:[
              {q:'Capital of Fiji?', options:['Suva','Nadi','Lautoka','Sigatoka'], answer:0}
            ],
            medium:[
              {q:'Fiji is in which ocean?', options:['Pacific','Atlantic','Indian','Arctic'], answer:0}
            ],
            hard:[
              {q:'Fiji is made up of many what?', options:['Islands','Peninsulas','Plains','Mountains only'], answer:0}
            ]
          },
          foods:{
            easy:[
              {q:'Which root is commonly eaten in Fiji?', options:['Taro','Potato','Rice','Maize'], answer:0}
            ],
            medium:[
              {q:'What is kokoda?', options:['Marinated fish (ceviche-like)','Soup','Bread','Pudding'], answer:0}
            ],
            hard:[
              {q:'Fijian lovo cooks use?', options:['Hot stones in an earth oven','Microwave','Frying pan','Oven'], answer:0}
            ]
          },
          animals:{
            easy:[
              {q:'Which marine creature is important for Fiji reefs?', options:['Coral reef fish','Penguin','Polar bear','Camel'], answer:0}
            ],
            medium:[
              {q:'Which mammal might be seen around Fiji?', options:['Dugong','Polar bear','Walrus','Manatee'], answer:0}
            ],
            hard:[
              {q:'Which bird group is common on islands?', options:['Seabirds','Elephants','Kangaroos','Moose'], answer:0}
            ]
          },
          weather:{
            easy:[
              {q:'Fiji typically has what climate?', options:['Tropical','Polar','Arid','Temperate'], answer:0}
            ],
            medium:[
              {q:'Cyclone season in Fiji is usually?', options:['Nov‚ÄìApr','Jun‚ÄìAug','Sep‚ÄìOct','May‚ÄìJun'], answer:0}
            ],
            hard:[
              {q:'Coral bleaching is caused by?', options:['Warm sea temperatures','Cold snaps','Volcanic ash only','Asteroids'], answer:0}
            ]
          }
      }},

    }; // end countriesDB

    // ---------- Map ----------
    const map = L.map('map',{ worldCopyJump:true }).setView([15,0],2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:6, attribution:'¬© OpenStreetMap'}).addTo(map);

    Object.entries(countriesDB).forEach(([code,c])=>{
      const m = L.marker([c.lat,c.lng]).addTo(map).bindPopup(c.country);
      m.on('click', ()=> onCountryClick(code) );
    });

    // ---------- Bank and rendering ----------
    function buildBank(countryKey){
      const c = countriesDB[countryKey];
      if(!c) return [];
      const diff = state.difficulty;
      const topics = Array.from(state.topics);
      let pool = [];
      topics.forEach(t=>{
        const arr = (((c.questions||{})[t]||{})[diff]) || [];
        arr.forEach(q => pool.push(Object.assign({}, q, {__topic:t, __country:c.country})));
      });
      return shuffle(pool);
    }

    function resetCurrentCountryBank(){
      if(!state.current) return;
      state.current.bank = buildBank(state.current.countryKey);
      state.current.idx = 0;
      renderNextQuestion();
    }

    function onCountryClick(countryKey){
      if(state.topics.size===0){
        $('qText').textContent = 'Please select at least one topic.';
        $('options').innerHTML=''; $('qImage').style.display='none';
        return;
      }
      state.current = { countryKey, bank: buildBank(countryKey), idx:0 };
      renderNextQuestion();
    }

    function renderNextQuestion(){
      const qText = $('qText'), optBox = $('options'), qImg = $('qImage');
      if(!state.current || state.current.bank.length===0){
        qText.textContent = 'No questions available for this selection. Try another country/topic/difficulty.';
        optBox.innerHTML=''; qImg.style.display='none'; return;
      }
      if(state.current.idx >= state.current.bank.length){
        qText.textContent = 'You finished this country\'s bank. Pick another country!';
        optBox.innerHTML=''; qImg.style.display='none'; return;
      }
      const q = state.current.bank[state.current.idx];
      const originalCorrect = q.options[q.answer];
      const shuffled = shuffle(q.options.slice());
      const correctIndex = shuffled.findIndex(x=>x===originalCorrect);

      qText.textContent = q.q;
      if(q.img){ qImg.src = q.img; qImg.style.display='block'; } else qImg.style.display='none';
      optBox.innerHTML='';
      shuffled.forEach((opt, idx)=>{
        const b = document.createElement('button');
        b.className='option';
        b.textContent = opt;
        b.addEventListener('click', ()=> checkAnswer(idx, correctIndex));
        optBox.appendChild(b);
      });
    }

    function checkAnswer(selectedIdx, correctIdx){
      const optBox = $('options'), buttons = Array.from(optBox.querySelectorAll('.option'));
      buttons.forEach((btn,i)=>{ btn.disabled=true; if(i===correctIdx) btn.classList.add('correct'); if(i===selectedIdx && i!==correctIdx) btn.classList.add('wrong'); });
      if(selectedIdx === correctIdx){
        state.score++; $('score').textContent = state.score;
        celebrateIfMilestone();
      } else {
        state.lives = Math.max(0, state.lives-1); $('lives').textContent = state.lives;
        if(state.lives<=0){ endGame('No lives left'); return; }
      }
      setTimeout(()=>{ state.current.idx++; renderNextQuestion(); }, 650);
    }

    // ---------- Timer & Controls ----------
    function startGame(){
      state.score = 0; state.lives = 3; state.milestonesHit.clear();
      $('score').textContent = 0; $('lives').textContent = 3;
      state.difficulty = $('difficulty').value; state.mode = $('mode').value;
      // topics
      Array.from(document.querySelectorAll('.pill')).forEach(p=>{
        if(p.getAttribute('data-active')==='true') state.topics.add(p.dataset.topic); else state.topics.delete(p.dataset.topic);
      });
      renderActiveTags();
      if(state.timer){ clearInterval(state.timer); state.timer = null; }
      if(state.mode === 'timed'){
        state.timeLeft = 60; $('timer').textContent = state.timeLeft;
        state.timer = setInterval(()=>{ state.timeLeft--; $('timer').textContent = state.timeLeft; if(state.timeLeft<=0) endGame("Time's up"); }, 1000);
      } else {
        $('timer').textContent = '‚àû';
        if(state.timer){ clearInterval(state.timer); state.timer=null; }
      }
      $('qText').textContent = 'Pick a country to get your first question.'; $('options').innerHTML=''; $('qImage').style.display='none';
    }

    function endGame(reason){
      if(state.timer){ clearInterval(state.timer); state.timer = null; }
      $('qText').textContent = `Game over: ${reason} Final score: ${state.score}`;
      $('options').innerHTML=''; $('qImage').style.display='none';
    }

    function fullReset(){
      if(state.timer){ clearInterval(state.timer); state.timer=null; }
      state.score = 0; state.lives = 3; state.current = null; state.milestonesHit.clear();
      state.timeLeft = 60; $('score').textContent = 0; $('lives').textContent = 3; $('timer').textContent = 60;
      $('qText').textContent = 'Pick a country to get your first question.'; $('options').innerHTML=''; $('qImage').style.display='none';
      Array.from(document.querySelectorAll('.pill')).forEach(p=> p.setAttribute('data-active','true'));
      state.topics = new Set(['countries','foods','animals','weather']);
      renderActiveTags();
    }

    // ---------- Init ----------
    loadHighScore();
    updateTimerVisibility = ()=> $('timerWrap').style.display = state.mode==='timed' ? 'block' : 'none';
    updateTimerVisibility();
    renderActiveTags();

    // helper to reset current bank when topics/difficulty change
    function resetCurrentCountryBank(){ if(state.current){ state.current.bank = buildBank(state.current.countryKey); state.current.idx = 0; renderNextQuestion(); } }

  </script>
</body>
</html>
